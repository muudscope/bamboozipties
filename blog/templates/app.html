{% extends "base.html" %}

{% block htmltitle %}
Blog CRUD
{% endblock %}

{% block content %}

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script> 
    <script>
        function load_table() {
            var url = '/blog/list.json';
            $.getJSON(url, null, function(data) {
              $.each(data, function(n, row) {
                $("#crud_table_blog tr:last").after(
                  '<tr id="post-id'+row.pk+'"><td>'+row.fields.title+'</td><td>'
                    +row.fields.name+'</td><td>'
                    +row.fields.content+'</td><td>'
                    +'<td><a href="#" onclick="return delete_entry('+row.pk+');">Delete</a>'
                    +'</tr>');
              });
            });
        }

        function delete_entry(id) {
          if( confirm("Delete Post?") ) {
            // They said yes

            var url = '/blog/delete/'+id+'.json';
            jQuery.post(url, function(data) {
                $("#post-id"+id).remove();
            });

          }
          return 0;
        }

        $(document).ready( load_table() 
        );
    </script>

    <h1>BLog CRUD</h1>

    <table border=2 id="crud_table_blog">
    <tr>
      <th>Title</th>
      <th>Name</th>
      <th>Content</th>
      <td></td>
    </tr>

    </table



{% endblock %}
